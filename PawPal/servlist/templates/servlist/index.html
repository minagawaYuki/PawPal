<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PawPal - Dashboard</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'servlist/css/styles.css' %}">
    <style>
        /* Notification Red Circle */
        .notification-btn .notification-indicator {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 10px;
            height: 10px;
            background-color: red;
            border-radius: 50%;
        }

        /* White Notification Dropdown Box */
        .notification-list {
            display: none;
            position: absolute;
            top: 50px;
            right: 10px;
            width: 300px;
            background-color: white;
            border: 1px solid #ccc;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-radius: 5px;
            padding: 15px;
            z-index: 1000;
        }

        .notification-item {
            padding: 10px;
            border-bottom: 1px solid #f1f1f1;
        }

        .notification-item:last-child {
            border-bottom: none;
        }

        .notification-item p {
            margin: 0;
            font-size: 14px;
            color: #333;
        }

        .notification-list p {
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="logo">Logo</div>
            <nav class="nav-menu">
                <a href="../dashboard" class="nav-item">
                    <img src="{% static 'servlist/images/paw-icon.svg' %}" alt="Dashboard icon">
                    Dashboard
                </a>
                <a href="../book" class="nav-item">
                    <img src="{% static 'servlist/images/calendar-icon.svg' %}" alt="Schedule icon">
                    Book a Schedule
                </a>
                <a href="../../transactions" class="nav-item">
                    <img src="{% static 'servlist/images/history-icon.svg' %}" alt="History icon">
                    Transaction History
                </a>
            </nav>
            <a href="#" class="logout">Log Out</a>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="header">
                <div class="notification-bar">
                    <div class="notification-text">Your booking for Shiro has been accepted</div>
                </div>
                <div class="user-menu">
                    <button class="notification-btn">
                        <img src="{% static 'servlist/images/notify-icon.svg' %}" alt="Notifications" class="icon">
                        {% if pending_bookings %}
                            <span class="notification-indicator"></span>
                        {% endif %}
                    </button>
                    <div class="notification-list">
                        {% for booking in pending_bookings %}
                            <div class="notification-item">
                                <p>Your booking for {{ booking.pet.pet_name }} - {{ booking.service.services }} on {{ booking.date }} is still pending.</p>
                            </div>
                        {% empty %}
                            <p>No pending bookings at the moment.</p>
                        {% endfor %}
                    </div>
                    <button class="settings-btn">
                        <img src="{% static 'servlist/images/settings-icon.svg' %}" alt="Settings" class="icon">
                    </button>
                    <div class="user-profile">
                        <a href="../../transactions">
                            <img src="{% static 'servlist/images/profile.jpg' %}" alt="Profile" class="profile-img">
                        </a>
                        <span id="profname">{{ first_name }}</span>
                    </div>
                </div>
            </header>

            <!-- Content Sections -->
            <section class="content">
                <div class="recent-bookings">
                    <h2>Recent Bookings</h2>
                    <div class="booking-item">
                        <span>Dog Walking</span>
                        <button class="book-again">Book Again</button>
                    </div>
                    <div class="booking-item">
                        <span>Overnight</span>
                        <button class="book-again">Book Again</button>
                    </div>
                    <div class="booking-item">
                        <span>Dog Walking</span>
                        <button class="book-again">Book Again</button>
                    </div>
                </div>

                <div class="pet-info">
                    <h2>Pet Information</h2>
                    <div class="pet-details">
                        <div class="info-row">
                            <span>Name: </span>
                        </div>
                        <div class="info-row">
                            <span>Type: </span>
                        </div>
                        <div class="info-row">
                            <span>Breed: </span>
                        </div>
                        <div class="info-row">
                            <span>Age: </span>
                        </div>
                        <div class="button-group">
                            <button class="add-pet">Add Another Pet</button>
                            <button class="schedule">Book a Schedule</button>
                        </div>
                    </div>
                </div>

                <div class="current-bookings">
                    <h2>Current Bookings</h2>
                    <div class="no-bookings">
                        <table>
                            <thead>
                                <tr>
                                    <th>Service Type</th>
                                    <th>Date</th>
                                    <th>Time</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for booking in bookings %}
                                    <tr>
                                        <td>{{ booking.service.services }}</td>
                                        <td>{{ booking.date }}</td>
                                        <td>{{ booking.time }}</td>
                                        <td>{{ booking.status }}</td>
                                    </tr>
                                {% empty %}
                                    <tr>
                                        <td colspan="4">No bookings available.</td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        // Toggle notification dropdown visibility
        document.querySelector('.notification-btn').addEventListener('click', function() {
            const notificationList = document.querySelector('.notification-list');
            const isHidden = notificationList.style.display === 'none' || notificationList.style.display === '';
            notificationList.style.display = isHidden ? 'block' : 'none';

            // Remove notification indicator after viewing
            if (isHidden) {
                document.querySelector('.notification-indicator')?.remove();
            }
        });

        // Close notification box if clicked outside
        document.addEventListener('click', function(event) {
            const notificationBtn = document.querySelector('.notification-btn');
            const notificationList = document.querySelector('.notification-list');
            if (!notificationBtn.contains(event.target) && !notificationList.contains(event.target)) {
                notificationList.style.display = 'none';
            }
        });
    </script>
</body>
</html>
